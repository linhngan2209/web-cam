{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/ADMIN/camera-web/src/utils/check_token.ts"],"sourcesContent":["import { jwtDecode } from 'jwt-decode';\r\nimport { useRouter } from 'next/navigation';\r\n\r\ninterface Hardware {\r\n    id: string;\r\n    // Thêm các trường khác của hardware\r\n}\r\n\r\nexport const checkToken = (\r\n    router: ReturnType<typeof useRouter>,\r\n    hardwares: Hardware[] \r\n): boolean => {\r\n    const token = typeof window !== 'undefined' ? localStorage.getItem('token') : null;\r\n    console.log('Token:', token);\r\n    if (!token || typeof token !== 'string') {\r\n        console.warn('Token không tồn tại hoặc không hợp lệ.');\r\n        router.push('/login');\r\n        return false;\r\n    }\r\n\r\n    try {\r\n        const decodedToken = jwtDecode(token);\r\n\r\n        // Kiểm tra trường exp trong token\r\n        if (!decodedToken.exp) {\r\n            console.warn('Token không có trường exp.');\r\n            localStorage.removeItem('token');\r\n            router.push('/login');\r\n            return false;\r\n        }\r\n\r\n        // Kiểm tra thời gian hết hạn của token\r\n        const expirationTime = decodedToken.exp * 1000;\r\n        const currentTime = Date.now();\r\n\r\n        if (currentTime >= expirationTime) {\r\n            console.warn('Token đã hết hạn.');\r\n            localStorage.removeItem('token');\r\n            router.push('/login');\r\n            return false;\r\n        }\r\n\r\n        if (hardwares && hardwares.length > 0) {\r\n            const firstHardwareId = hardwares[0].id;\r\n            router.replace(`/authenticated/hardware/${firstHardwareId}`);\r\n        } else {\r\n            router.replace('/no-hardware');\r\n        }\r\n\r\n        return true;\r\n    } catch (error) {\r\n        console.error('Lỗi khi giải mã token:', error);\r\n        localStorage.removeItem('token');\r\n        router.push('/login');\r\n        return false;\r\n    }\r\n};"],"names":[],"mappings":";;;AAAA;;AAQO,MAAM,aAAa,CACtB,QACA;IAEA,MAAM,QAAQ,6EAAgE;IAC9E,QAAQ,GAAG,CAAC,UAAU;IACtB,wCAAyC;QACrC,QAAQ,IAAI,CAAC;QACb,OAAO,IAAI,CAAC;QACZ,OAAO;IACX;;AAsCJ"}},
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/ADMIN/camera-web/src/hooks/useHardwareQuery.ts"],"sourcesContent":["import { useQuery, useQueryClient } from '@tanstack/react-query';\r\nimport { useRouter } from 'next/router';\r\nimport { useEffect } from 'react';\r\nimport { useAuth } from '@/contexts/AuthenticationContext';\r\nimport axiosInstance from '@/services/apiClient';\r\n\r\ninterface Hardware {\r\n    id: string;\r\n    // Thêm các trường khác của hardware\r\n}\r\n\r\n// Hàm fetch dữ liệu\r\nconst fetchHardwares = async (): Promise<Hardware[]> => {\r\n    const response = await axiosInstance.get('/api/user/get-user-hardware', {\r\n        params: { limit: 10, page: 1 },\r\n        timeout: 10000,\r\n    });\r\n    return response.data.data || [];\r\n};\r\n\r\nexport const useHardwareQuery = (shouldRedirect = false) => {\r\n    const { isLoggedIn } = useAuth();\r\n    const router = useRouter();\r\n    const queryClient = useQueryClient();\r\n\r\n    const query = useQuery({\r\n        queryKey: ['hardwares'],\r\n        queryFn: fetchHardwares,\r\n        enabled: !!isLoggedIn, \r\n    });\r\n\r\n    useEffect(() => {\r\n        if (shouldRedirect && query.data && !query.isLoading) {\r\n            if (query.data.length > 0) {\r\n                router.push(`/hardware/${query.data[0].id}`);\r\n            } else {\r\n                router.push('/');\r\n            }\r\n        }\r\n    }, [query.data, query.isLoading, shouldRedirect, router]);\r\n\r\n    const refreshHardwares = () => {\r\n        queryClient.invalidateQueries({ queryKey: ['hardwares'] });\r\n    };\r\n\r\n    return {\r\n        ...query,\r\n        hardwares: query.data || [],\r\n        refreshHardwares,\r\n    };\r\n};\r\n"],"names":[],"mappings":";;;AACA;AACA;AACA;AACA;AAJA;AAAA;;;;;;AAWA,oBAAoB;AACpB,MAAM,iBAAiB;IACnB,MAAM,WAAW,MAAM,4HAAA,CAAA,UAAa,CAAC,GAAG,CAAC,+BAA+B;QACpE,QAAQ;YAAE,OAAO;YAAI,MAAM;QAAE;QAC7B,SAAS;IACb;IACA,OAAO,SAAS,IAAI,CAAC,IAAI,IAAI,EAAE;AACnC;AAEO,MAAM,mBAAmB,CAAC,iBAAiB,KAAK;IACnD,MAAM,EAAE,UAAU,EAAE,GAAG,CAAA,GAAA,yIAAA,CAAA,UAAO,AAAD;IAC7B,MAAM,SAAS,CAAA,GAAA,8HAAA,CAAA,YAAS,AAAD;IACvB,MAAM,cAAc,CAAA,GAAA,sLAAA,CAAA,iBAAc,AAAD;IAEjC,MAAM,QAAQ,CAAA,GAAA,2KAAA,CAAA,WAAQ,AAAD,EAAE;QACnB,UAAU;YAAC;SAAY;QACvB,SAAS;QACT,SAAS,CAAC,CAAC;IACf;IAEA,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACN,IAAI,kBAAkB,MAAM,IAAI,IAAI,CAAC,MAAM,SAAS,EAAE;YAClD,IAAI,MAAM,IAAI,CAAC,MAAM,GAAG,GAAG;gBACvB,OAAO,IAAI,CAAC,CAAC,UAAU,EAAE,MAAM,IAAI,CAAC,EAAE,CAAC,EAAE,EAAE;YAC/C,OAAO;gBACH,OAAO,IAAI,CAAC;YAChB;QACJ;IACJ,GAAG;QAAC,MAAM,IAAI;QAAE,MAAM,SAAS;QAAE;QAAgB;KAAO;IAExD,MAAM,mBAAmB;QACrB,YAAY,iBAAiB,CAAC;YAAE,UAAU;gBAAC;aAAY;QAAC;IAC5D;IAEA,OAAO;QACH,GAAG,KAAK;QACR,WAAW,MAAM,IAAI,IAAI,EAAE;QAC3B;IACJ;AACJ"}},
    {"offset": {"line": 91, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 97, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/ADMIN/camera-web/src/components/Loading.tsx"],"sourcesContent":["const Loading = () => {\r\n  return (\r\n    <div className=\"fixed inset-0 flex items-center justify-center bg-white bg-opacity-80\">\r\n      <div className=\"flex flex-col items-center\">\r\n        <div className=\"w-12 h-12 border-4 border-indigo-300 border-t-4 border-t-indigo-600 rounded-full animate-spin\"></div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Loading;"],"names":[],"mappings":";;;;;AAAA,MAAM,UAAU;IACd,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;;;;;;;;;;;;;;;;AAIvB;uCAEe"}},
    {"offset": {"line": 126, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 132, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/ADMIN/camera-web/src/app/page.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { checkToken } from '../utils/check_token';\nimport { useHardwareQuery } from '@/hooks/useHardwareQuery';\nimport Loading from '@/components/Loading';\n\nexport default function HomePage() {\n  const router = useRouter();\n  const { hardwares, isLoading: isHardwareLoading } = useHardwareQuery(true);\n\n  useEffect(() => {\n    checkToken(router, hardwares);\n  }, [router, hardwares]);\n\n  return (\n    <div className=\"flex items-center justify-center h-screen\">\n      <Loading />\n    </div>\n  );\n}"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AACA;AANA;;;;;;;AAQe,SAAS;IACtB,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,EAAE,SAAS,EAAE,WAAW,iBAAiB,EAAE,GAAG,CAAA,GAAA,gIAAA,CAAA,mBAAgB,AAAD,EAAE;IAErE,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,CAAA,GAAA,2HAAA,CAAA,aAAU,AAAD,EAAE,QAAQ;IACrB,GAAG;QAAC;QAAQ;KAAU;IAEtB,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC,6HAAA,CAAA,UAAO;;;;;;;;;;AAGd"}},
    {"offset": {"line": 170, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}