{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/ADMIN/camera-web/src/utils/check_token.ts"],"sourcesContent":["import { jwtDecode } from 'jwt-decode';\r\nimport { useRouter } from 'next/navigation';\r\n\r\ninterface Hardware {\r\n    id: string;\r\n    // Thêm các trường khác của hardware\r\n}\r\n\r\nexport const checkToken = (\r\n    router: ReturnType<typeof useRouter>,\r\n    hardwares: Hardware[] \r\n): boolean => {\r\n    const token = typeof window !== 'undefined' ? localStorage.getItem('token') : null;\r\n    console.log('Token:', token);\r\n    if (!token || typeof token !== 'string') {\r\n        console.warn('Token không tồn tại hoặc không hợp lệ.');\r\n        router.push('/login');\r\n        return false;\r\n    }\r\n\r\n    try {\r\n        const decodedToken = jwtDecode(token);\r\n\r\n        // Kiểm tra trường exp trong token\r\n        if (!decodedToken.exp) {\r\n            console.warn('Token không có trường exp.');\r\n            localStorage.removeItem('token');\r\n            router.push('/login');\r\n            return false;\r\n        }\r\n\r\n        // Kiểm tra thời gian hết hạn của token\r\n        const expirationTime = decodedToken.exp * 1000;\r\n        const currentTime = Date.now();\r\n\r\n        if (currentTime >= expirationTime) {\r\n            console.warn('Token đã hết hạn.');\r\n            localStorage.removeItem('token');\r\n            router.push('/login');\r\n            return false;\r\n        }\r\n\r\n        if (hardwares && hardwares.length > 0) {\r\n            const firstHardwareId = hardwares[0].id;\r\n            router.replace(`/authenticated/hardware/${firstHardwareId}`);\r\n        } else {\r\n            router.replace('/no-hardware');\r\n        }\r\n\r\n        return true;\r\n    } catch (error) {\r\n        console.error('Lỗi khi giải mã token:', error);\r\n        localStorage.removeItem('token');\r\n        router.push('/login');\r\n        return false;\r\n    }\r\n};"],"names":[],"mappings":";;;AAAA;;AAQO,MAAM,aAAa,CACtB,QACA;IAEA,MAAM,QAAQ,uCAAgC,aAAa,OAAO,CAAC;IACnE,QAAQ,GAAG,CAAC,UAAU;IACtB,IAAI,CAAC,SAAS,OAAO,UAAU,UAAU;QACrC,QAAQ,IAAI,CAAC;QACb,OAAO,IAAI,CAAC;QACZ,OAAO;IACX;IAEA,IAAI;QACA,MAAM,eAAe,CAAA,GAAA,yJAAA,CAAA,YAAS,AAAD,EAAE;QAE/B,kCAAkC;QAClC,IAAI,CAAC,aAAa,GAAG,EAAE;YACnB,QAAQ,IAAI,CAAC;YACb,aAAa,UAAU,CAAC;YACxB,OAAO,IAAI,CAAC;YACZ,OAAO;QACX;QAEA,uCAAuC;QACvC,MAAM,iBAAiB,aAAa,GAAG,GAAG;QAC1C,MAAM,cAAc,KAAK,GAAG;QAE5B,IAAI,eAAe,gBAAgB;YAC/B,QAAQ,IAAI,CAAC;YACb,aAAa,UAAU,CAAC;YACxB,OAAO,IAAI,CAAC;YACZ,OAAO;QACX;QAEA,IAAI,aAAa,UAAU,MAAM,GAAG,GAAG;YACnC,MAAM,kBAAkB,SAAS,CAAC,EAAE,CAAC,EAAE;YACvC,OAAO,OAAO,CAAC,CAAC,wBAAwB,EAAE,iBAAiB;QAC/D,OAAO;YACH,OAAO,OAAO,CAAC;QACnB;QAEA,OAAO;IACX,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,0BAA0B;QACxC,aAAa,UAAU,CAAC;QACxB,OAAO,IAAI,CAAC;QACZ,OAAO;IACX;AACJ"}},
    {"offset": {"line": 55, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 61, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/ADMIN/camera-web/src/hooks/useHardwareQuery.ts"],"sourcesContent":["import { useQuery, useQueryClient } from '@tanstack/react-query';\r\nimport { useRouter } from 'next/router';\r\nimport { useEffect } from 'react';\r\nimport { useAuth } from '@/contexts/AuthenticationContext';\r\nimport axiosInstance from '@/services/apiClient';\r\n\r\ninterface Hardware {\r\n    id: string;\r\n    // Thêm các trường khác của hardware\r\n}\r\n\r\n// Hàm fetch dữ liệu\r\nconst fetchHardwares = async (): Promise<Hardware[]> => {\r\n    const response = await axiosInstance.get('/api/user/get-user-hardware', {\r\n        params: { limit: 10, page: 1 },\r\n        timeout: 10000,\r\n    });\r\n    return response.data.data || [];\r\n};\r\n\r\nexport const useHardwareQuery = (shouldRedirect = false) => {\r\n    const { isLoggedIn } = useAuth();\r\n    const router = useRouter();\r\n    const queryClient = useQueryClient();\r\n\r\n    const query = useQuery({\r\n        queryKey: ['hardwares'],\r\n        queryFn: fetchHardwares,\r\n        enabled: !!isLoggedIn, \r\n    });\r\n\r\n    useEffect(() => {\r\n        if (shouldRedirect && query.data && !query.isLoading) {\r\n            if (query.data.length > 0) {\r\n                router.push(`/hardware/${query.data[0].id}`);\r\n            } else {\r\n                router.push('/');\r\n            }\r\n        }\r\n    }, [query.data, query.isLoading, shouldRedirect, router]);\r\n\r\n    const refreshHardwares = () => {\r\n        queryClient.invalidateQueries({ queryKey: ['hardwares'] });\r\n    };\r\n\r\n    return {\r\n        ...query,\r\n        hardwares: query.data || [],\r\n        refreshHardwares,\r\n    };\r\n};\r\n"],"names":[],"mappings":";;;AACA;AACA;AACA;AACA;AAJA;AAAA;;;;;;;AAWA,oBAAoB;AACpB,MAAM,iBAAiB;IACnB,MAAM,WAAW,MAAM,+HAAA,CAAA,UAAa,CAAC,GAAG,CAAC,+BAA+B;QACpE,QAAQ;YAAE,OAAO;YAAI,MAAM;QAAE;QAC7B,SAAS;IACb;IACA,OAAO,SAAS,IAAI,CAAC,IAAI,IAAI,EAAE;AACnC;AAEO,MAAM,mBAAmB,CAAC,iBAAiB,KAAK;;IACnD,MAAM,EAAE,UAAU,EAAE,GAAG,CAAA,GAAA,4IAAA,CAAA,UAAO,AAAD;IAC7B,MAAM,SAAS,CAAA,GAAA,iIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,cAAc,CAAA,GAAA,yLAAA,CAAA,iBAAc,AAAD;IAEjC,MAAM,QAAQ,CAAA,GAAA,8KAAA,CAAA,WAAQ,AAAD,EAAE;QACnB,UAAU;YAAC;SAAY;QACvB,SAAS;QACT,SAAS,CAAC,CAAC;IACf;IAEA,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;sCAAE;YACN,IAAI,kBAAkB,MAAM,IAAI,IAAI,CAAC,MAAM,SAAS,EAAE;gBAClD,IAAI,MAAM,IAAI,CAAC,MAAM,GAAG,GAAG;oBACvB,OAAO,IAAI,CAAC,CAAC,UAAU,EAAE,MAAM,IAAI,CAAC,EAAE,CAAC,EAAE,EAAE;gBAC/C,OAAO;oBACH,OAAO,IAAI,CAAC;gBAChB;YACJ;QACJ;qCAAG;QAAC,MAAM,IAAI;QAAE,MAAM,SAAS;QAAE;QAAgB;KAAO;IAExD,MAAM,mBAAmB;QACrB,YAAY,iBAAiB,CAAC;YAAE,UAAU;gBAAC;aAAY;QAAC;IAC5D;IAEA,OAAO;QACH,GAAG,KAAK;QACR,WAAW,MAAM,IAAI,IAAI,EAAE;QAC3B;IACJ;AACJ;GA9Ba;;QACc,4IAAA,CAAA,UAAO;QACf,iIAAA,CAAA,YAAS;QACJ,yLAAA,CAAA,iBAAc;QAEpB,8KAAA,CAAA,WAAQ"}},
    {"offset": {"line": 139, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 145, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/ADMIN/camera-web/src/components/Loading.tsx"],"sourcesContent":["const Loading = () => {\r\n  return (\r\n    <div className=\"fixed inset-0 flex items-center justify-center bg-white bg-opacity-80\">\r\n      <div className=\"flex flex-col items-center\">\r\n        <div className=\"w-12 h-12 border-4 border-indigo-300 border-t-4 border-t-indigo-600 rounded-full animate-spin\"></div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Loading;"],"names":[],"mappings":";;;;;AAAA,MAAM,UAAU;IACd,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;;;;;;;;;;;;;;;;AAIvB;KARM;uCAUS"}},
    {"offset": {"line": 180, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 186, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/ADMIN/camera-web/src/app/page.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { checkToken } from '../utils/check_token';\nimport { useHardwareQuery } from '@/hooks/useHardwareQuery';\nimport Loading from '@/components/Loading';\n\nexport default function HomePage() {\n  const router = useRouter();\n  const { hardwares, isLoading: isHardwareLoading } = useHardwareQuery(true);\n\n  useEffect(() => {\n    checkToken(router, hardwares);\n  }, [router, hardwares]);\n\n  return (\n    <div className=\"flex items-center justify-center h-screen\">\n      <Loading />\n    </div>\n  );\n}"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AACA;;;AANA;;;;;;AAQe,SAAS;;IACtB,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,EAAE,SAAS,EAAE,WAAW,iBAAiB,EAAE,GAAG,CAAA,GAAA,mIAAA,CAAA,mBAAgB,AAAD,EAAE;IAErE,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;8BAAE;YACR,CAAA,GAAA,8HAAA,CAAA,aAAU,AAAD,EAAE,QAAQ;QACrB;6BAAG;QAAC;QAAQ;KAAU;IAEtB,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC,gIAAA,CAAA,UAAO;;;;;;;;;;AAGd;GAbwB;;QACP,qIAAA,CAAA,YAAS;QAC4B,mIAAA,CAAA,mBAAgB;;;KAF9C"}},
    {"offset": {"line": 240, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}